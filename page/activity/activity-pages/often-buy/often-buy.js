var app = getApp();
Page({
    data: {
        foodAll: [{
            goods_describe: "大白菜（约3-5斤/棵）约3-5斤/棵，叶茎洁白、叶面嫩绿，鲜绿紧实，大小均匀，极少或无黑点",
            goods_name: "大白菜(约3-5斤/棵)",
            id: "2101",
            image_path: "https://www.shicaionline.com/image/goods/1468664023184.jpg",
            is_favorite: 0,
            is_gift: "0",
            is_seckill_offer: "0",
            is_special_offer: "1",
            max_qty: "0.00",
            min_qty: "4.00",
            on_sales: "1",
            price: "1.48",
            sales_volume: "546311",
            small_image_path: "https://www.shicaionline.com/image/goods/1468664023184_150.jpg",
            special_count: "305",
            special_limit: "0",
            special_offer_end: "1482681600",
            special_offer_price: "1.33",
            special_offer_start: "1482422400",
            type_id: "133",
            unit_id: "2",
            unit_name: "斤"
        },{
            goods_describe: "大白菜（约3-5斤/棵）约3-5斤/棵，叶茎洁白、叶面嫩绿，鲜绿紧实，大小均匀，极少或无黑点",
            goods_name: "大白菜(约3-5斤/棵)",
            id: "2101",
            image_path: "https://www.shicaionline.com/image/goods/1468664023184.jpg",
            is_favorite: 0,
            is_gift: "0",
            is_seckill_offer: "0",
            is_special_offer: "1",
            max_qty: "0.00",
            min_qty: "4.00",
            on_sales: "1",
            price: "1.48",
            sales_volume: "546311",
            small_image_path: "https://www.shicaionline.com/image/goods/1468664023184_150.jpg",
            special_count: "305",
            special_limit: "0",
            special_offer_end: "1482681600",
            special_offer_price: "1.33",
            special_offer_start: "1482422400",
            type_id: "133",
            unit_id: "2",
            unit_name: "斤"
        },{
            goods_describe: "大白菜（约3-5斤/棵）约3-5斤/棵，叶茎洁白、叶面嫩绿，鲜绿紧实，大小均匀，极少或无黑点",
            goods_name: "大白菜(约3-5斤/棵)",
            id: "2101",
            image_path: "https://www.shicaionline.com/image/goods/1468664023184.jpg",
            is_favorite: 0,
            is_gift: "0",
            is_seckill_offer: "0",
            is_special_offer: "1",
            max_qty: "0.00",
            min_qty: "4.00",
            on_sales: "1",
            price: "1.48",
            sales_volume: "546311",
            small_image_path: "https://www.shicaionline.com/image/goods/1468664023184_150.jpg",
            special_count: "305",
            special_limit: "0",
            special_offer_end: "1482681600",
            special_offer_price: "1.33",
            special_offer_start: "1482422400",
            type_id: "133",
            unit_id: "2",
            unit_name: "斤"
        },{
            goods_describe: "大白菜（约3-5斤/棵）约3-5斤/棵，叶茎洁白、叶面嫩绿，鲜绿紧实，大小均匀，极少或无黑点",
            goods_name: "大白菜(约3-5斤/棵)",
            id: "2101",
            image_path: "https://www.shicaionline.com/image/goods/1468664023184.jpg",
            is_favorite: 0,
            is_gift: "0",
            is_seckill_offer: "0",
            is_special_offer: "1",
            max_qty: "0.00",
            min_qty: "4.00",
            on_sales: "1",
            price: "1.48",
            sales_volume: "546311",
            small_image_path: "https://www.shicaionline.com/image/goods/1468664023184_150.jpg",
            special_count: "305",
            special_limit: "0",
            special_offer_end: "1482681600",
            special_offer_price: "1.33",
            special_offer_start: "1482422400",
            type_id: "133",
            unit_id: "2",
            unit_name: "斤"
        }],
        more:[{
            goods_describe: "大白菜（约3-5斤/棵）约3-5斤/棵，叶茎洁白、叶面嫩绿，鲜绿紧实，大小均匀，极少或无黑点",
            goods_name: "大白菜(约3-5斤/棵)",
            id: "2101",
            image_path: "https://www.shicaionline.com/image/goods/1468664910709.jpg",
            is_favorite: 0,
            is_gift: "0",
            is_seckill_offer: "0",
            is_special_offer: "1",
            max_qty: "0.00",
            min_qty: "4.00",
            on_sales: "1",
            price: "1.48",
            sales_volume: "546311",
            small_image_path: "https://www.shicaionline.com/image/goods/1468664910709_150.jpg",
            special_count: "305",
            special_limit: "0",
            special_offer_end: "1482681600",
            special_offer_price: "1.33",
            special_offer_start: "1482422400",
            type_id: "133",
            unit_id: "2",
            unit_name: "斤"
        },{
            goods_describe: "大白菜（约3-5斤/棵）约3-5斤/棵，叶茎洁白、叶面嫩绿，鲜绿紧实，大小均匀，极少或无黑点",
            goods_name: "大白菜(约3-5斤/棵)",
            id: "2101",
            image_path: "https://www.shicaionline.com/image/goods/1468664910709.jpg",
            is_favorite: 0,
            is_gift: "0",
            is_seckill_offer: "0",
            is_special_offer: "1",
            max_qty: "0.00",
            min_qty: "4.00",
            on_sales: "1",
            price: "1.48",
            sales_volume: "546311",
            small_image_path: "https://www.shicaionline.com/image/goods/1468664910709_150.jpg",
            special_count: "305",
            special_limit: "0",
            special_offer_end: "1482681600",
            special_offer_price: "1.33",
            special_offer_start: "1482422400",
            type_id: "133",
            unit_id: "2",
            unit_name: "斤"
        }],
        nowNum:"0",    
        flag:true,
        is_coll:"../../../../image/cancel-coll.png",
        mainHeight:app.globalData.winHeight,
        foodFlag:true
    },
    collection:function(e){
        if(this.data.is_coll == "../../../../image/cancel-coll.png"){
            this.setData({ is_coll:"../../../../image/active-coll.png" });
        }else{
            this.setData({ is_coll:"../../../../image/cancel-coll.png" });
        }
    },
    addQty:function(e){
    	if(e.target.dataset.nowNum == "")return;
    	var nowNum = e.target.dataset.nowNum >= 999 ? 999 : Number(e.target.dataset.nowNum) + 1;
        this.setData({ nowNum:nowNum });
    },
    subQty:function(e){
    	if(e.target.dataset.nowNum == "")return;
    	var nowNum = e.target.dataset.nowNum <= 0 ? 0 : Number(e.target.dataset.nowNum) - 1;
        this.setData({ nowNum:nowNum });
    },
    changeNum:function(e){
    	var nowNum = e.detail.value;
    	this.setData({ nowNum:nowNum });
    },
    bigShow:function(e){
    	var arr = e.target.dataset.bigArea.split("?");
    	var bigArea = {
    		name:arr[0],
    		describe:arr[1],
    		price:arr[2],
    		unit_name:arr[3],
    		image_path:arr[4]
    	}
    	this.setData({bigArea:bigArea,flag:false,foodFlag:false});
    },
    closeShow:function(e){
    	this.setData({flag:true,foodFlag:true});
    },
    onLoad: function() {
        console.log("load-often");
    },
    onShow: function() {
        console.log("show-often");
    },
    goBack: function() {

        wx.navigateBack({ delta: 1 });
    },
    loadMore:function(){
        let that = this;
        let flag = false;
        let foodAll = this.data.foodAll;
        foodAll = foodAll.concat(this.data.more);
        this.setData({foodAll,flag});
        setTimeout(function(){
            flag = true;
            that.setData({flag});
        },500)
    }
})
